schema: '2.0'
stages:
  prepare:
    cmd: python src/prepare.py data/raw/aclImdb
    deps:
    - path: data/raw/aclImdb
      md5: b7d922d51f419be6193fa9252b38e581.dir
      size: 221218527
      nfiles: 100011
    - path: src/prepare.py
      md5: 37c2b1765cef2d4996287cf0b7b06809
      size: 1661
    params:
      params.yaml:
        prepare.batch_size: 32
        prepare.seed: 20170428
        prepare.validation_split: 0.2
    outs:
    - path: data/prepared
      md5: 56c893de462d0b7a1c37333d5c2e5a82.dir
      size: 132762409
      nfiles: 9
  featurize:
    cmd: python src/featurize.py data/prepared data/features
    deps:
    - path: data/prepared
      md5: 56c893de462d0b7a1c37333d5c2e5a82.dir
      size: 132762409
      nfiles: 9
    - path: src/featurize.py
      md5: e7ec611c5feb723b403779db882cac21
      size: 3203
    params:
      params.yaml:
        featurize.embedding_dim: 128
        featurize.max_features: 20000
        featurize.sequence_length: 500
    outs:
    - path: data/features
      md5: b566ac116e090ea75095030f8c3135bb.dir
      size: 400587843
      nfiles: 9
  train:
    cmd: python src/train.py data/features models
    deps:
    - path: data/features
      md5: b566ac116e090ea75095030f8c3135bb.dir
      size: 400587843
      nfiles: 9
    - path: src/train.py
      md5: 4db7e5d60c2765ee932ce5929abe00e9
      size: 3349
    params:
      params.yaml:
        train.epochs: 10
        train.model_dropout: 0.5
        train.model_kernel_size: 128
        train.model_padding: 5
        train.model_strides: 3
    outs:
    - path: models/mlops-thesis-text-classification.onnx
      md5: bf0c4d38d910b82e049ca6549cde938e
      size: 10968261
  evaluate:
    cmd: python src/evaluate.py models/mlops-thesis-text-classification.onnx data/features
    deps:
    - path: data/features
      md5: b566ac116e090ea75095030f8c3135bb.dir
      size: 400587843
      nfiles: 9
    - path: models/mlops-thesis-text-classification.onnx
      md5: bf0c4d38d910b82e049ca6549cde938e
      size: 10968261
    - path: src/evaluate.py
      md5: 4720c0e5d4ee2e0d17af88bdb58a5d06
      size: 435
    outs:
    - path: src/metrics.json
      md5: 36b6f7f84284ae8a58c53c42bdeb271d
      size: 88
